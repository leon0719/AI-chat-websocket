services:
  api:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    ports:
      - "8000:8000"
    env_file:
      - ../.env.prod
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/api/health/"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

# 生產環境注意事項：
# 1. 資料庫和 Redis 應使用外部服務 (RDS, ElastiCache, Cloud SQL 等)
# 2. 在 .env.prod 中設定正確的 DATABASE_URL 和 REDIS_URL
# 3. 建議在前面加上 nginx 或 load balancer
# 4. 確保 ALLOWED_HOSTS 設定正確的域名
